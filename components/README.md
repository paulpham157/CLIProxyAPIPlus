# Code Preview Component

A React component for displaying code with syntax highlighting, copy-to-clipboard functionality, and iframe preview for UI components generated by Bolt.new and v0.dev.

## Features

- **Syntax Highlighting**: Uses `react-syntax-highlighter` with the One Dark theme
- **Copy to Clipboard**: One-click code copying with visual feedback
- **Live Preview**: Iframe-based preview for HTML, JSX, and TSX components
- **Tab Switching**: Toggle between code view and preview for UI components
- **Responsive Design**: Mobile-friendly layout
- **Type Safe**: Full TypeScript support

## Installation

```bash
npm install react react-dom react-markdown react-syntax-highlighter
npm install --save-dev @types/react @types/react-dom @types/react-syntax-highlighter typescript
```

## Usage

### Basic Usage

```tsx
import { CodePreview } from './components/chat/code-preview';

function MyComponent() {
  const code = `
function hello() {
  console.log("Hello, world!");
}
  `;

  return <CodePreview code={code} language="javascript" />;
}
```

### With File Name

```tsx
<CodePreview 
  code={code} 
  language="typescript" 
  fileName="example.ts"
/>
```

### With Preview for Bolt.new/v0.dev UI Components

```tsx
<CodePreview 
  code={htmlCode} 
  language="html" 
  showPreview={true}
  isBoltOrV0={true}
  fileName="component.html"
/>
```

### With React/JSX Components

```tsx
const jsxCode = `
function Button() {
  return <button>Click me!</button>;
}

ReactDOM.render(<Button />, document.getElementById('root'));
`;

<CodePreview 
  code={jsxCode} 
  language="jsx" 
  showPreview={true}
  isBoltOrV0={true}
/>
```

## Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `code` | `string` | *required* | The code content to display |
| `language` | `string` | `'javascript'` | Programming language for syntax highlighting |
| `fileName` | `string` | `undefined` | Optional file name to display in header |
| `showPreview` | `boolean` | `false` | Enable preview tab functionality |
| `isBoltOrV0` | `boolean` | `false` | Indicate if code is from Bolt.new or v0.dev for smart preview detection |

## Supported Languages

The component supports all languages supported by `react-syntax-highlighter`, including:
- JavaScript/TypeScript
- JSX/TSX
- HTML/CSS
- Python
- Go
- Java
- And many more...

## Preview Mode

The preview feature automatically detects UI components and provides:
- Full HTML document preview
- React component preview with Babel transpilation
- Sandboxed iframe for security
- Responsive preview frame

Preview mode activates when:
1. `showPreview` is `true`
2. `isBoltOrV0` is `true`
3. Language is `html`, `jsx`, or `tsx`, or code contains HTML/React syntax

## Styling

The component uses inline styles with CSS-in-JS (styled-jsx) for encapsulation. The default theme is One Dark, matching popular code editors.

You can customize the syntax highlighter theme by modifying the import:

```tsx
import { atomDark } from 'react-syntax-highlighter/dist/cjs/styles/prism';
// Use atomDark instead of oneDark in the component
```

## Security

The iframe preview uses the `sandbox` attribute with `allow-scripts` and `allow-same-origin` to provide a secure preview environment while allowing basic functionality.

## Browser Support

- Modern browsers with ES2020+ support
- Clipboard API for copy functionality
- iframe sandboxing support
